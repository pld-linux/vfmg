diff -Nura vfmg-0.9.18.orig/vfmg vfmg-0.9.18.new/vfmg
--- vfmg-0.9.18.orig/vfmg	2004-12-09 22:30:45.472547896 +0100
+++ vfmg-0.9.18.new/vfmg	2004-12-09 22:39:09.042993552 +0100
@@ -41,7 +41,7 @@
 	);
 
 if($o_help) {
-	print "Usage:	$0 [options] {aewm, afterstep, blackbox, enlightenment, fbpanel, fluxbox, fvwm, fvwm2, icewm, openbox, olvwm, qvwm, wmaker, wmaker-old, xfce4, xpde}
+	print "Usage:	$0 [options] {aewm, afterstep, blackbox, enlightenment, fbpanel, fluxbox, fvwm, fvwm2, icewm, metisse, openbox, olvwm, qvwm, wmaker, wmaker-old, xfce4, xpde}
 	-h, --help	- print this help
 	-t, --tags	- echo omitted tags to stderr
 	-e, --end	- echo omitted XDG file ending to stderr
@@ -60,13 +60,13 @@
 	exit;
 }
 
-die "Missing argument {aewm, afterstep, blackbox, enlightenment, fbpanel, fluxbox, fvwm, fvwm2, icewm, openbox, olvwm, qvwm, wmaker, wmaker-old, xfce4, xpde}\n"
+die "Missing argument {aewm, afterstep, blackbox, enlightenment, fbpanel, fluxbox, fvwm, fvwm2, icewm, metisse, openbox, olvwm, qvwm, wmaker, wmaker-old, xfce4, xpde}\n"
 	unless exists $ARGV[0];
 $o_output=$ARGV[0];
 die "Unrecognized argument: $o_output\n"
-	unless $o_output=~/^(aewm|afterstep|blackbox|enlightenment|fbpanel|fluxbox|fvwm|fvwm2|icewm|openbox|olvwm|qvwm|wmaker|wmaker-old|xfce4|xpde)$/;
+	unless $o_output=~/^(aewm|afterstep|blackbox|enlightenment|fbpanel|fluxbox|fvwm|fvwm2|icewm|metisse|openbox|olvwm|qvwm|wmaker|wmaker-old|xfce4|xpde)$/;
 
-$o_full=1 if $o_icons and $o_output=~/^(enlightenment)$/;
+$o_full=1 if $o_icons and $o_output=~/^(enlightenment|metisse)$/;
 	
 my $tmp="$ENV{'HOME'}/.local/share";
 $tmp="$ENV{'XDG_DATA_HOME'}" if $ENV{'XDG_DATA_HOME'};
@@ -839,6 +839,46 @@
 	print "\n";
 }
 
+sub metisse {
+	my $no=$_[0];
+	my $file=$_[1];
+	$file=~s|^\.||;
+	my $basename=$_[2];
+	my $icon="";
+	foreach my $entry(keys %{$menu[$no]}) {
+		if($menu[$no]{$entry}[0]>=0) {
+			$name=substr($entry,1);
+			$name=~s|/||g;
+			my $menutitle=$name;
+			$name=~s/\s+/_/g;
+		      metisse($menu[$no]{$entry}[0],"$file.$name","$menutitle");
+		}
+	}
+	if (!$file) {
+		return;
+	}
+	print "DestroyMenu $file\n";
+	print "AddToMenu $file \"$basename\" Title\n";
+	foreach my $entry(sort keys %{$menu[$no]}) {
+		$icon=$menu[$no]{$entry}[1] if $o_icons;
+		$icon=scale_icon($icon,"png","-geometry 21x18") if $icon;
+		$icon="\%$icon\%" if $icon;
+		
+		if($menu[$no]{$entry}[0]<0) {
+			$name=$entry;
+			$name=~s/\"/\\\"/g;
+			print "+ \"$icon$name\"\tExec exec $menu[$no]{$entry}[2]\n";
+		} else {
+			$name=substr($entry,1);
+			$name=~s|/||g;
+			my $menutitle=$name;
+			$name=~s/\s+/_/g;
+			print "+ \"$icon$menutitle\"\tPopup\t$file.$name\n";
+		}
+	}
+	print "\n";
+}
+
 sub olvwm {
 	my $no=$_[0];
 	foreach my $entry(sort keys %{$menu[$no]}) {
@@ -1062,6 +1102,19 @@
 	fvwm2($o_strip);
 	exit;
 }
+
+if($o_output eq "metisse") {
+	$icon_dir="$ENV{'HOME'}/.fvwm-metisse/icons";
+	if(! -d "$icon_dir") {
+		if(-f "$icon_dir") {
+			rename("$icon_dir","$icon_dir.old");
+		}
+		mkpath("$icon_dir",0,0700);
+	}
+	metisse($o_strip,"", "metisse");
+	exit;
+}
+		
 if($o_output eq "olvwm") {
 	olvwm($o_strip);
 	exit;
diff -Nura vfmg-0.9.18.orig/vfmg.html vfmg-0.9.18.new/vfmg.html
--- vfmg-0.9.18.orig/vfmg.html	2004-12-09 22:30:45.463549264 +0100
+++ vfmg-0.9.18.new/vfmg.html	2004-12-09 22:29:06.784550752 +0100
@@ -4,7 +4,7 @@
 	<title>VFolders Menu Generator home page</title>
 	<meta name="author" content="gotar">
 	<meta name="description" content="VFolders Menu Generator home page">
-	<meta name="keywords" content="vfmg, menu, window manager, vfolders, aewm, afterstep, blackbox, enlightenment, fluxbox, fvwm, fvwm2, icewm, olvwm, qvwm, wmaker, xfce4, xpde, fbpanel, openbox">
+	<meta name="keywords" content="vfmg, menu, window manager, vfolders, aewm, afterstep, blackbox, enlightenment, fluxbox, fvwm, fvwm2, icewm, metisse, olvwm, qvwm, wmaker, xfce4, xpde, fbpanel, openbox">
 	<meta http-equiv="Content-Type" CONTENT="text/html; charset=iso-8859-1">
 </head>
 <body bgcolor=lightblue>
@@ -41,6 +41,7 @@
 <a TARGET="_blank" href="http://www.fvwm.org/">fvwm</a>,
 <a TARGET="_blank" href="http://www.fvwm.org/">fvwm2</a>,
 <a TARGET="_blank" href="http://www.icewm.org/">icewm</a>,
+<a TARGET="_blank" href="http://insitu.lri.fr/~chapuis/metisse/">metisse</a>,
 <a TARGET="_blank" href="http://www.phys.columbia.edu/~flame/olvwm.html">olvwm</a>,
 <a TARGET="_blank" href="http://www.icculus.org/openbox/">openbox</a>,
 <a TARGET="_blank" href="http://www.qvwm.org/">qvwm</a>,
diff -Nura vfmg-0.9.18.orig/vfmg-zsh vfmg-0.9.18.new/vfmg-zsh
--- vfmg-0.9.18.orig/vfmg-zsh	2004-08-01 08:11:55.000000000 +0200
+++ vfmg-0.9.18.new/vfmg-zsh	2004-12-09 22:29:06.785550600 +0100
@@ -1,7 +1,7 @@
 #compdef vfmg
 
 _arguments \
-	':Output:(aewm afterstep blackbox enlightenment fbpanel fluxbox fvwm2 icewm openbox olvwm qvwm wmaker wmaker-old xfce4 xpde)' \
+	':Output:(aewm afterstep blackbox enlightenment fbpanel fluxbox fvwm2 icewm metisse openbox olvwm qvwm wmaker wmaker-old xfce4 xpde)' \
 	'(-h --help)'{-h,--help}'[print help]' \
 	'(-t --tags)'{-t,--tags}'[echo omitted tags to stderr]' \
 	'(-e --end)'{-e,--end}'[echo omitted XDG file ending to stderr]' \
